<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Median of Row Wise Sorted Matrix</title>
<style>
        /* A clean, modern, and responsive base style for the articles */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #fdfdfd;
            margin: 0;
            padding: 0;
        }

        /* Main container for the article content */
        .container {
            margin: 5px;
            /* Replaced '20px auto' to add margin on all sides */
            padding: 10px;
            background-color: #fff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        /* Main article title */
        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 0.5em;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 0.5em;
            text-align: center;
        }

        /* Make images responsive and centered */
        img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            display: block;
            /* To allow auto margins to work */
            margin: 1em auto;
            /* Adds some vertical spacing and centers horizontally */
        }

        /* Center figures which often wrap images */
        figure {
            text-align: center;
            margin: 1.5em 0;
        }

        /* Center and style YouTube video wrapper for responsiveness */
        .yt-video-wrapper {
            position: relative;
            overflow: hidden;
            width: 100%;
            padding-top: 56.25%;
            /* 16:9 Aspect Ratio */
            margin: 1.5em auto;
            /* Center block element */
            border-radius: 8px;
        }

        .yt-video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Basic code block styling */
        pre {
            background-color: #2d2d2d;
            /* A common dark background for code */
            color: #f8f8f2;
            padding: 10px;
            margin: 0px;
            border-radius: 5px;
            overflow-x: auto;
            /* Allow horizontal scrolling for long code lines */
            font-family: "Fira Code", "Consolas", "Monaco", monospace;
            font-size: 0.9em;
        }

        code {
            font-family: "Fira Code", "Consolas", "Monaco", monospace;
        }

        /* Improve styling for links */
        a {
            color: #3498db;
            text-decoration: none;
            transition: color 0.2s ease-in-out;
        }

        a:hover {
            color: #2980b9;
            text-decoration: underline;
        }

        /* --- Code Section Tabs Styling --- */
        .code-tabs {
            display: flex;
            border-bottom: 1px solid #e7e7e7;
            margin-bottom: 1em;
            align-items: center;
        }

        .code-tab {
            padding: 10px 15px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            font-size: 1em;
            color: #555;
            transition: all 0.2s ease-in-out;
        }

        .code-tab:hover {
            background-color: #f9f9f9;
            color: #333;
        }

        .code-tab.dsa_article_code_active {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
        }

        .copy-btn {
            margin-left: auto;
            cursor: pointer;
            padding: 10px;
        }

        .copy-btn path {
            fill: #aaa;
            transition: fill 0.2s;
        }

        .copy-btn:hover path {
            fill: #333;
        }

        .copy-btn.dsa_article_code_active path {
            fill: #3498db;
        }

        .code-block {
            display: none;
        }

        .code-block.dsa_article_code_active {
            display: block;
        }

        /* Practice */
        .practice,
        .new-disclaimer {
            display: flex;
            justify-content: space-evenly;
            align-items: center;
        }

        .new-disclaimer {
            justify-content: center;
        }

        /* --- End Code Section Tabs Styling --- */

        /* --- Accordion/Dropdown Styling --- */
        details {
            margin-bottom: 1em;
            border: 1px solid #e7e7e7;
            border-radius: 6px;
            overflow: hidden;
            /* Keeps content within rounded corners */
            padding: 0;
            /* Reset any default padding */
        }

        summary {
            list-style: none;
            /* Hide the default marker */
            cursor: pointer;
            padding: 15px 20px;
            background-color: #f9f9f9;
            font-weight: 500;
            color: #2c3e50;
            transition: background-color 0.2s ease-in-out;
        }

        summary::-webkit-details-marker {
            display: none;
            /* Hide default marker for Chrome/Safari */
        }

        summary:hover {
            background-color: #f1f1f1;
        }

        /* Content inside the dropdowns */
        .common-drops,
        .atricle_example_content {
            padding: 10px 10px 0;
            border-bottom: 10px;
            background-color: #fff;
            border-top: 1px solid #e7e7e7;
        }

        /* Full padding for example */
        .atricle_example_content {
            padding: 10px;
        }

        /* Additional padding for details content that doesn't have specific classes */
        details> :not(summary) {
            padding-left: 10px;
            padding-right: 10px;
        }

        .dsa_article_youtube_video .yt-video-wrapper {
            padding-top: 56.25%;
            margin: 0;
            border-radius: 0;
            padding-left: 0;
            padding-right: 0;
        }

        /* Nested dropdown summaries */
        .secondary-summary {
            background-color: #fafafa;
            padding: 12px 20px;
            font-weight: normal;
        }

        .secondary-summary:hover {
            background-color: #f0f0f0;
        }

        /* --- End Accordion/Dropdown Styling --- */

        /* Hide specific UI elements based on user request */
        .problem-buttons img,
        .arrow-svg,
        .box-e.tooltip,
        .three-boxes.box-d svg,
        .horizontal_navbar_dsa_article {
            display: none;
        }

        /* Responsive adjustments */
        @media (min-width: 769px) {
            .container {
                max-width: 960px;
                margin: 20px auto;
            }
        }

        @media (max-width: 768px) {
            .container {
                margin: 0;
                padding: 10px;
            }

            h1 {
                font-size: 2em;
            }

            .code-tabs {
                flex-wrap: wrap;
                /* Allow tabs to wrap on small screens */
            }

            /* Reduce padding on mobile for details sections */
            details> :not(summary) {
                padding-left: 10px;
                padding-right: 10px;
            }

            .common-drops,
            .atricle_example_content {
                padding: 10px 10px 0;
            }

            .atricle_example_content {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
<div class="container">
<header>
<h1>Median of Row Wise Sorted Matrix</h1>
</header>
<article>
<p><strong>Problem Statement:</strong> Given a row-wise sorted matrix of size MXN, where M is no. of rows and N is no.
    of columns, find the median in the given matrix.</p>
<p><strong>Note:</strong> MXN is odd.</p>
<!-- This is Examples Drop-Down -->
<div id="article_examples">
<details class="article_example_details">
<summary class="article_example_summary">
<span><strong>
                    Examples
                </strong>
</span>
<svg class="arrow-svg opacity-75" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
<path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z"></path>
</svg>
</summary>
<div class="atricle_example_content">
<pre class="wp-block-preformatted">
                    <span><strong>Example 1:</strong></span>
                    <span><strong>Input Format:</strong>M = 3, N = 3, matrix[][] =</span>
                    1 4 9 
                    2 5 6
                    3 8 7
                    <span><strong>Result:</strong> 5</span>
                    
                    <span><strong>Explanation: </strong> If we find the linear sorted array, the array becomes 1 2 3 4 5 6 7 8 9. So, median = 5</span>
                    
                    <span><strong>Example 2:</strong></span>
                    <span><strong>Input Format:</strong>M = 3, N = 3, matrix[][] =</span>
                    1 3 8 
                    2 3 4
                    1 2 5
                    <span><strong>Result:</strong> 3</span>
                    
                    <span><strong>Explanation: </strong> If we find the linear sorted array, the array becomes 1 1 2 2 3 3 4 5 7 8. So, median = 3</span>
                    
                </pre>
</div>
</details>
</div>
<p class="new-disclaimer"><strong><em>Disclaimer</em></strong>: <em>Don’t jump directly to the solution, try it out
        yourself first. <strong><a href="https://www.codingninjas.com/studio/problems/median-of-a-row-wise-sorted-matrix_1115473?utm_source=striver&amp;utm_medium=website&amp;utm_campaign=a_zcoursetuf" rel="noreferrer noopener" target="_blank">Problem Link</a></strong></em></p>
<!-- This is Approaches Drop-Down -->
<div class="dsa_article_dropdown_approachs">
<!-- Approach - 1 Starts from here -->
<div id="brute-force-approach">
<details>
<summary class="main-summary">
<span>
<!-- Change Name Here -->
                    Brute-force Approach
                </span>
<svg class="arrow-svg opacity-75" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
<path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z">
</path>
</svg>
</summary>
<div class="common-drops">
<details class="secondary-details" open="">
<summary class="secondary-summary">
<span>
                            Algorithm / Intuition
                        </span>
<svg class="arrow-svg opacity-75" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
<path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z">
</path>
</svg>
</summary>
<div class="approach-algorithm">
<p>The extremely naive approach is to use a linear array/list to store the elements of the given
                            matrix. Now, we will sort the list and return the middle element.
                        </p>
<p><strong>Algorithm:</strong></p>
<ol>
<li>We will use a loop(say i) to select a particular row at a time.</li>
<li>Next, we will use another loop(say j) for every row to traverse each column.</li>
<li>Inside the loops, we will store each element, matrix[i][j] to a linear array/list.</li>
<li>Finally, we will return the middle element of that linear array.</li>
</ol>
<p><strong>Dry-run: </strong>Please refer to the attached <em> <strong><a href="https://youtu.be/Q9wXgdxJq48?si=VyUUzdNNPfdvmPGq" rel="noreferrer noopener" target="_blank">video</a></strong></em> for a detailed dry-run.</p>
</div>
</details>
<details class="code-section secondary-details">
<summary class="secondary-summary">
<span>
                            Code
                        </span>
<svg class="arrow-svg opacity-75" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
<path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z">
</path>
</svg>
</summary>
<div class="code-tabs">
<button class="code-tab dsa_article_code_active" data-lang="cpp">C++</button>
<button class="code-tab" data-lang="java">Java</button>
<button class="code-tab" data-lang="python">Python</button>
<button class="code-tab" data-lang="javascript">JavaScript</button>
<svg class="copy-btn" fill="none" height="20" viewbox="0 0 17 20" width="17" xmlns="http://www.w3.org/2000/svg">
<path d="M2 20C1.45 20 0.979002 19.804 0.587002 19.412C0.195002 19.02 -0.000664969 18.5493 1.69779e-06 18V4H2V18H13V20H2ZM6 16C5.45 16 4.979 15.804 4.587 15.412C4.195 15.02 3.99934 14.5493 4 14V2C4 1.45 4.196 0.979002 4.588 0.587002C4.98 0.195002 5.45067 -0.000664969 6 1.69779e-06H15C15.55 1.69779e-06 16.021 0.196002 16.413 0.588002C16.805 0.980002 17.0007 1.45067 17 2V14C17 14.55 16.804 15.021 16.412 15.413C16.02 15.805 15.5493 16.0007 15 16H6ZM6 14H15V2H6V14Z">
</path>
</svg>
</div>
<div class="code-content">
<div class="code-block dsa_article_code_active" data-lang="cpp">
<pre class="wp-block-code">
                                    <code class="language-cpp" lang="cpp">
#include&lt;bits/stdc++.h&gt;
using namespace std;

int median(vector&lt;vector&lt;int&gt;&gt; &amp;matrix, int m, int n) {
    vector&lt;int&gt; lst;

    //traverse the matrix and
    //copy the elements to list:
    for (int i = 0; i &lt; m; i++) {
        for (int j = 0; j &lt; n; j++) {
            lst.push_back(matrix[i][j]);
        }
    }

    //sort the list:
    sort(lst.begin(), lst.end());
    return lst[(m * n) / 2];
}

int main() {
    vector&lt;vector&lt;int&gt;&gt; matrix = {
        {1, 2, 3, 4, 5},
        {8, 9, 11, 12, 13},
        {21, 23, 25, 27, 29}
    };
    int m = matrix.size(), n = matrix[0].size();
    int ans = median(matrix, m, n);
    cout &lt;&lt; "The median element is: " &lt;&lt; ans &lt;&lt; endl;
    return 0;
}
                                    </code>
                                </pre>
</div>
<div class="code-block" data-lang="java">
<pre class="wp-block-code">
                                    <code class="language-java" lang="java">
import java.util.*;

public class tUf {
    public static int median(int matrix[][], int m, int n) {
        List&lt;Integer&gt; lst = new ArrayList&lt;&gt;();

        // Traverse the matrix and
        // copy the elements to the list:
        for (int i = 0; i &lt; m; i++) {
            for (int j = 0; j &lt; n; j++) {
                lst.add(matrix[i][j]);
            }
        }

        // Sort the list:
        Collections.sort(lst);
        return lst.get((m * n) / 2);
    }

    public static void main(String[] args) {
        int matrix[][] = {
            {1, 2, 3, 4, 5},
            {8, 9, 11, 12, 13},
            {21, 23, 25, 27, 29}
        };
        int m = matrix.length, n = matrix[0].length;
        int ans = median(matrix, m, n);
        System.out.println("The median element is: " + ans);
    }
}
    
                                    </code>
                                </pre>
</div>
<div class="code-block" data-lang="python">
<pre class="wp-block-code">
                                    <code class="language-python" lang="python">
def median(matrix, m, n):
    lst = []

    # Traverse the matrix and copy the elements to the list:
    for i in range(m):
        for j in range(n):
            lst.append(matrix[i][j])

    # Sort the list:
    lst.sort()
    return lst[(m * n) // 2]

matrix = [
    [1, 2, 3, 4, 5],
    [8, 9, 11, 12, 13],
    [21, 23, 25, 27, 29]
]
m = len(matrix)
n = len(matrix[0])
ans = median(matrix, m, n)
print("The median element is:", ans)
                                    </code>
                                </pre>
</div>
<div class="code-block" data-lang="javascript">
<pre class="wp-block-code">
                                <code class="language-javascript" lang="javascript">
function median(matrix, m, n) {
    const lst = [];

    // Traverse the matrix and
    // copy the elements to the list:
    for (let i = 0; i &lt; m; i++) {
        for (let j = 0; j &lt; n; j++) {
            lst.push(matrix[i][j]);
        }
    }

    // Sort the list:
    lst.sort((a, b) =&gt; a - b);
    return lst[Math.floor((m * n) / 2)];
}


const matrix = [
    [1, 2, 3, 4, 5],
    [8, 9, 11, 12, 13],
    [21, 23, 25, 27, 29]
];
const m = matrix.length;
const n = matrix[0].length;
const ans = median(matrix, m, n);
console.log("The median element is: " + ans);
    
                                </code>
                            </pre>
</div>
<p>
<strong>Output: </strong>The median element is: 11
                        </p>
</div>
</details>
<details class="secondary-details">
<summary class="secondary-summary">
<span>
                            Complexity Analysis
                        </span>
<svg class="arrow-svg opacity-75" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
<path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z">
</path>
</svg>
</summary>
<p>
<p><strong>Time Complexity:</strong> O(MXN) + O(MXN(log(MXN))), where M = number of row in the given
                        matrix, N = number of columns in the given matrix</p>
<p><strong>Reason:</strong> At first, we are traversing the matrix to copy the elements. This takes
                        O(MXN) time complexity. Then we are sorting the linear array of size (MXN), that takes
                        O(MXN(log(MXN))) time complexity</p>
<p><strong>Space Complexity: </strong>O(MXN) as we are using a temporary list to store the elements
                        of the matrix.</p>
</p>
</details>
</div>
</details>
</div>
<!-- Approach - 1 Ends here -->
<!-- Approach - 2 Starts from here -->
<div id="optimal-approach">
<details>
<summary class="main-summary">
<span>
                    Optimal Approach
                </span>
<svg class="arrow-svg opacity-75" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
<path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z">
</path>
</svg>
</summary>
<div class="common-drops">
<details class="secondary-details" open="">
<summary class="secondary-summary">
<span>
                            Algorithm / Intuition
                        </span>
<svg class="arrow-svg opacity-75" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
<path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z">
</path>
</svg>
</summary>
<div class="approach-algorithm">
<p>Now, if we wish to further optimize the previous approach we cannot afford to check every
                            element. So, we have to eliminate some parts to reduce the time complexity under O(MXN).
                            This is where the binary search algorithm comes in
                        </p>
<p>The primary objective of the Binary Search algorithm is to efficiently determine the
                            appropriate half to eliminate, thereby reducing the search space by half. It does this by
                            determining a specific condition that ensures that the target is not present in that half.
                        </p>
<p><strong>Observations:</strong></p>
<ol>
<li>
<p><strong>What is the search space where we will apply binary search?</strong></p>
<span>If we carefully observe, our answer lies between the smallest and the largest
                                    number in the given matrix. So, the search space will be <strong>[min(matrix),
                                        max(matrix)].</strong></span>
</li>
<li>
<p><strong>While applying binary search how to check if an element ‘x’ is a possible
                                        median?</strong></p>
<span>If ‘x’ is the median, the <strong>number of elements smaller or equal to ‘x’
                                    </strong> will be surely <strong> greater than (MXN) // 2 (integer
                                        division).</strong></span>
</li>
<li>
<p><strong>How to check how many numbers are smaller or equal to an element
                                        ‘mid’?</strong></p>
<span>One of the ways is to traverse the whole matrix and count the numbers. But in that
                                    case, the time complexity will be high. So, we have to find other ways. It is given
                                    that the matrix is row-wise sorted. So, we can apply the concept of <strong><a href="https://takeuforward.org/arrays/implement-upper-bound/" rel="noreferrer noopener" target="_blank">upper bound</a></strong>
</span>
<ul>
<li>
                                        For every particular row, we will find the upper bound of the current element
                                        ‘mid’. The index returned will be the number of smaller or equal elements in
                                        that row.
                                    </li>
<li>We will do it for each row and add them to get the total number for the whole
                                        matrix.</li>
<li>Mathematically, <strong>smaller_equal_in_row = upperBound(matrix[row],
                                            mid)</strong></li>
</ul>
</li>
</ol>
<p>We will just convert the above observation into code.</p>
<p><strong>Algorithm:</strong></p>
<ol>
<li><strong>Calculate min(matrix) and max(matrix):</strong> As the given matrix is row-wise
                                sorted the minimum element will be the minimum element in the first column and the
                                maximum will be the maximum in the last column.</li>
<li><strong>Place the 2 pointers low and high:</strong> Initially, we will place the
                                pointers. The pointer low will point to min(matrix) and the high will point to
                                max(matrix).</li>
<li><strong>Calculate the ‘mid’:</strong> Now, inside a loop, we will calculate the value of
                                ‘mid’ using the following formula: <strong>mid = (low+high) // 2 ( ‘//’ refers to
                                    integer division)</strong></li>
<li><strong>Use the calculateSmallEqual() function to get the number of elements &lt;=
                                        mid:</strong> Inside the function, we will use the above-mentioned upper bound
                                        formula for each row and calculate the total number of elements &lt;= mid. Then we
                                            will return the total number from the function <strong>
                                            calculateSmallEqual().</strong></li>
<li><strong>If smallEqual &lt;= (M*N) // 2:</strong> We can conclude that our median must be a
                                        bigger number. So, we will eliminate the left i.e. the smaller half (low =
                                        mid+1).</li>
<li><strong>If smallEqual &gt; (M*N) // 2:</strong> We can conclude that the element mid might
                                be the median. But we have to reach the smallest number to find the actual median. So,
                                in this case, we will remove the right half( i.e. high = mid-1).</li>
</ol>
<p>The steps from 3-6 will be inside a loop and the loop will continue until low crosses high
                        </p>
<p><strong>Note:</strong> Please make sure to refer to the <strong><a href="https://youtu.be/Q9wXgdxJq48?si=5GmckDfMGdX_zbav" rel="noreferrer noopener" target="_blank">video</a></strong> and try out some test cases of your own
                            to understand, how the pointer ‘low’ will be always pointing to the answer in this case.
                            This is also the reason we have not used any extra variable here to store the answer.</p>
<p><strong>Dry-run: </strong>Please refer to the attached <em> <strong><a href="https://youtu.be/Q9wXgdxJq48?si=VyUUzdNNPfdvmPGq" rel="noreferrer noopener" target="_blank">video</a></strong></em> for a detailed dry-run.</p>
</div>
</details>
<details class="code-section secondary-details">
<summary class="secondary-summary">
<span>
                            Code
                        </span>
<svg class="arrow-svg opacity-75" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
<path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z">
</path>
</svg>
</summary>
<div class="code-tabs">
<button class="code-tab dsa_article_code_active" data-lang="cpp">C++</button>
<button class="code-tab" data-lang="java">Java</button>
<button class="code-tab" data-lang="python">Python</button>
<button class="code-tab" data-lang="javascript">JavaScript</button>
<svg class="copy-btn" fill="none" height="20" viewbox="0 0 17 20" width="17" xmlns="http://www.w3.org/2000/svg">
<path d="M2 20C1.45 20 0.979002 19.804 0.587002 19.412C0.195002 19.02 -0.000664969 18.5493 1.69779e-06 18V4H2V18H13V20H2ZM6 16C5.45 16 4.979 15.804 4.587 15.412C4.195 15.02 3.99934 14.5493 4 14V2C4 1.45 4.196 0.979002 4.588 0.587002C4.98 0.195002 5.45067 -0.000664969 6 1.69779e-06H15C15.55 1.69779e-06 16.021 0.196002 16.413 0.588002C16.805 0.980002 17.0007 1.45067 17 2V14C17 14.55 16.804 15.021 16.412 15.413C16.02 15.805 15.5493 16.0007 15 16H6ZM6 14H15V2H6V14Z">
</path>
</svg>
</div>
<div class="code-content">
<div class="code-block dsa_article_code_active" data-lang="cpp">
<pre class="wp-block-code">
                                    <code class="language-cpp" lang="cpp">
#include&lt;bits/stdc++.h&gt;
using namespace std;

int upperBound(vector&lt;int&gt; &amp;arr, int x, int n) {
    int low = 0, high = n - 1;
    int ans = n;

    while (low &lt;= high) {
        int mid = (low + high) / 2;
        // maybe an answer
        if (arr[mid] &gt; x) {
            ans = mid;
            //look for smaller index on the left
            high = mid - 1;
        }
        else {
            low = mid + 1; // look on the right
        }
    }
    return ans;
}

int countSmallEqual(vector&lt;vector&lt;int&gt;&gt; &amp;matrix, int m, int n, int x) {
    int cnt = 0;
    for (int i = 0; i &lt; m; i++) {
        cnt += upperBound(matrix[i], x, n);
    }
    return cnt;
}

int median(vector&lt;vector&lt;int&gt;&gt; &amp;matrix, int m, int n) {
    int low = INT_MAX, high = INT_MIN;

    //point low and high to right elements:
    for (int i = 0; i &lt; m; i++) {
        low = min(low, matrix[i][0]);
        high = max(high, matrix[i][n - 1]);
    }

    int req = (n * m) / 2;
    while (low &lt;= high) {
        int mid = (low + high) / 2;
        int smallEqual = countSmallEqual(matrix, m, n, mid);
        if (smallEqual &lt;= req) low = mid + 1;
        else high = mid - 1;
    }
    return low;
}

int main() {
    vector&lt;vector&lt;int&gt;&gt; matrix = {
        {1, 2, 3, 4, 5},
        {8, 9, 11, 12, 13},
        {21, 23, 25, 27, 29}
    };
    int m = matrix.size(), n = matrix[0].size();
    int ans = median(matrix, m, n);
    cout &lt;&lt; "The median element is: " &lt;&lt; ans &lt;&lt; endl;
    return 0;
}
                                    </code>
                                </pre>
</div>
<div class="code-block" data-lang="java">
<pre class="wp-block-code">
                                    <code class="language-java" lang="java">
import java.util.*;

class tUf {
    static int upperBound(int[] arr, int x, int n) {
        int low = 0, high = n - 1;
        int ans = n;

        while (low &lt;= high) {
            int mid = (low + high) / 2;
            // maybe an answer
            if (arr[mid] &gt; x) {
                ans = mid;
                // look for a smaller index on the left
                high = mid - 1;
            } else {
                low = mid + 1; // look on the right
            }
        }
        return ans;
    }

    static int countSmallEqual(int[][] matrix, int m, int n, int x) {
        int cnt = 0;
        for (int i = 0; i &lt; m; i++) {
            cnt += upperBound(matrix[i], x, n);
        }
        return cnt;
    }

    static int median(int[][] matrix, int m, int n) {
        int low = Integer.MAX_VALUE, high = Integer.MIN_VALUE;

        // point low and high to right elements
        for (int i = 0; i &lt; m; i++) {
            low = Math.min(low, matrix[i][0]);
            high = Math.max(high, matrix[i][n - 1]);
        }

        int req = (n * m) / 2;
        while (low &lt;= high) {
            int mid = (low + high) / 2;
            int smallEqual = countSmallEqual(matrix, m, n, mid);
            if (smallEqual &lt;= req) low = mid + 1;
            else high = mid - 1;
        }
        return low;
    }

    public static void main(String[] args) {
        int[][] matrix = {
            {1, 2, 3, 4, 5},
            {8, 9, 11, 12, 13},
            {21, 23, 25, 27, 29}
        };
        int m = matrix.length;
        int n = matrix[0].length;
        int ans = median(matrix, m, n);
        System.out.println("The median element is: " + ans);
    }
}
                                    </code>
                                </pre>
</div>
<div class="code-block" data-lang="python">
<pre class="wp-block-code">
                                    <code class="language-python" lang="python">
                         
def upperBound(arr, x, n):
    low = 0
    high = n - 1
    ans = n

    while low &lt;= high:
        mid = (low + high) // 2
        # maybe an answer
        if arr[mid] &gt; x:
            ans = mid
            # look for a smaller index on the left
            high = mid - 1
        else:
            low = mid + 1  # look on the right

    return ans

def countSmallEqual(matrix, m, n, x):
    cnt = 0
    for i in range(m):
        cnt += upperBound(matrix[i], x, n)
    return cnt

def median(matrix, m, n):
    low = float('inf')
    high = float('-inf')

    # point low and high to the right elements
    for i in range(m):
        low = min(low, matrix[i][0])
        high = max(high, matrix[i][n - 1])

    req = (n * m) // 2
    while low &lt;= high:
        mid = (low + high) // 2
        smallEqual = countSmallEqual(matrix, m, n, mid)
        if smallEqual &lt;= req:
            low = mid + 1
        else:
            high = mid - 1

    return low

if __name__ == "__main__":
    matrix = [
        [1, 2, 3, 4, 5],
        [8, 9, 11, 12, 13],
        [21, 23, 25, 27, 29]
    ]
    m = len(matrix)
    n = len(matrix[0])
    ans = median(matrix, m, n)
    print("The median element is:", ans)
                                    </code>
                                </pre>
</div>
<div class="code-block" data-lang="javascript">
<pre class="wp-block-code">
                                <code class="language-javascript" lang="javascript">
function upperBound(arr, x, n) {
    let low = 0, high = n - 1;
    let ans = n;

    while (low &lt;= high) {
        let mid = Math.floor((low + high) / 2);
        // maybe an answer
        if (arr[mid] &gt; x) {
            ans = mid;
            // look for a smaller index on the left
            high = mid - 1;
        }
        else {
            low = mid + 1; // look on the right
        }
    }
    return ans;
}

function countSmallEqual(matrix, m, n, x) {
    let cnt = 0;
    for (let i = 0; i &lt; m; i++) {
        cnt += upperBound(matrix[i], x, n);
    }
    return cnt;
}

function median(matrix, m, n) {
    let low = Number.MAX_SAFE_INTEGER, high = Number.MIN_SAFE_INTEGER;

    // point low and high to the right elements:
    for (let i = 0; i &lt; m; i++) {
        low = Math.min(low, matrix[i][0]);
        high = Math.max(high, matrix[i][n - 1]);
    }

    let req = Math.floor((n * m) / 2);
    while (low &lt;= high) {
        let mid = Math.floor((low + high) / 2);
        let smallEqual = countSmallEqual(matrix, m, n, mid);
        if (smallEqual &lt;= req) low = mid + 1;
        else high = mid - 1;
    }
    return low;
}


const matrix = [
    [1, 2, 3, 4, 5],
    [8, 9, 11, 12, 13],
    [21, 23, 25, 27, 29]
];
const m = matrix.length;
const n = matrix[0].length;
const ans = median(matrix, m, n);
console.log("The median element is: " + ans);             
                                </code>
                            </pre>
</div>
<p>
<strong>Output: </strong>The median element is: 11
                        </p>
</div>
</details>
<details class="secondary-details">
<summary class="secondary-summary">
<span>
                            Complexity Analysis
                        </span>
<svg class="arrow-svg opacity-75" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
<path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z">
</path>
</svg>
</summary>
<p>
<p><strong>Time Complexity: </strong>O(log(109)) X O(M(logN)), where M = number of rows in the given matrix, N = number of columns in the given matrix</p>
<p><strong>Reason: </strong>Our search space lies between [0, 109] as the min(matrix) can be 0 and the max(matrix) can be 109. We are applying binary search in this search space and it takes O(log(109)) time complexity. Then we call countSmallEqual() function for every ‘mid’ and this function takes O(M(logN)) time complexity.</p>
<p></p>
<p><strong>Space Complexity :</strong> O(1) as we are not using any extra space</p>
</p>
</details>
</div>
</details>
</div>
</div>
<!-- This is Video Explination Drop-Down -->
<div class="dsa_article_youtube_video" id="dsa_article_video_explanation">
<details>
<summary class="main-summary">
<span>
                Video Explanation
            </span>
<svg class="arrow-svg opacity-75" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
<path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z"></path>
</svg>
</summary>
<div class="yt-video-wrapper">
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" frameborder="0" height="315" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/63fPPOdIr2c" title="YouTube video player" width="560"></iframe>
</div>
</details>
</div>
<script src="https://takeuforward.org/UXApproachDropDowns/2ApproachJSScript.js"></script>
<blockquote class="wp-block-quote">
    Special thanks to <strong><a href="https://www.linkedin.com/in/kriti39/">KRITIDIPTA GHOSH</a></strong> for
    contributing to this article on takeUforward. If you also wish to share your knowledge with the takeUforward
    fam,<strong><a href="https://takeuforward.org/interviews/paid-work-from-home-internship-at-takeuforward/"> please
            check out this article</a></strong>
</blockquote>
<script>

    const codeSections = document.querySelectorAll('.code-section');

    // Get last selected language from localStorage or set default value
    let lastSelectedLanguage = localStorage.getItem('lastSelectedLanguage') || 'cpp';

    codeSections.forEach((section, sectionIndex) => {
        const codeTabs = section.querySelectorAll('.code-tab');
        const codeBlocks = section.querySelectorAll('.code-block');
        const copyBtn = section.querySelector('.copy-btn');

        codeTabs.forEach((tab) => {
            tab.addEventListener('click', () => {
                codeTabs.forEach((t) => {
                    t.classList.remove('dsa_article_code_active');
                });
                tab.classList.add('dsa_article_code_active');

                const lang = tab.dataset.lang;
                const activeBlock = section.querySelector(`.code-block[data-lang="${lang}"]`);
                codeBlocks.forEach((block) => {
                    if (block === activeBlock) {
                        block.classList.add('dsa_article_code_active');
                    } else {
                        block.classList.remove('dsa_article_code_active');
                    }
                });

                // Update last selected language for all sections and store in localStorage
                lastSelectedLanguage = lang;
                localStorage.setItem('lastSelectedLanguage', lang);
                codeSections.forEach((otherSection, otherIndex) => {
                    if (otherIndex !== sectionIndex) {
                        const otherTabs = otherSection.querySelectorAll('.code-tab');
                        otherTabs.forEach((otherTab) => {
                            if (otherTab.dataset.lang === lang) {
                                otherTab.classList.add('dsa_article_code_active');
                            } else {
                                otherTab.classList.remove('dsa_article_code_active');
                            }
                        });
                        const otherActiveBlock = otherSection.querySelector(`.code-block[data-lang="${lang}"]`);
                        const otherCodeBlocks = otherSection.querySelectorAll('.code-block');
                        otherCodeBlocks.forEach((block) => {
                            if (block === otherActiveBlock) {
                                block.classList.add('dsa_article_code_active');
                            } else {
                                block.classList.remove('dsa_article_code_active');
                            }
                        });
                    }
                });
            });
        });

        // Handle copy button click event
        copyBtn.addEventListener('click', () => {
            const activeBlock = section.querySelector('.code-block.dsa_article_code_active code');
            navigator.clipboard.writeText(activeBlock.innerText);
            copyBtn.classList.add('dsa_article_code_active');
            setTimeout(() => {
                copyBtn.classList.remove('dsa_article_code_active');
            }, 1000);
        });
    });

    // Set initial state of the tabs
    codeSections.forEach((section) => {
        const codeTabs = section.querySelectorAll('.code-tab');
        const codeBlocks = section.querySelectorAll('.code-block');

        codeTabs.forEach((tab) => {
            if (tab.dataset.lang === lastSelectedLanguage) {
                tab.classList.add('dsa_article_code_active');
            } else {
                tab.classList.remove('dsa_article_code_active');
            }
        });

        codeBlocks.forEach((block) => {
            if (block.dataset.lang === lastSelectedLanguage) {
                block.classList.add('dsa_article_code_active');
            } else {
                block.classList.remove('dsa_article_code_active');
            }
        });
    });
</script>
<link href="assets/4237ffca7ce6aadb438c457e0a675b12.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/go.min.js"></script>
<script src="index.js"></script>
<script>hljs.highlightAll();</script>
</article>
</div>
<script>
        document.addEventListener('DOMContentLoaded', function () {
            // This script fixes the functionality of the code language switcher tabs
            // that are injected from the JSON content. It uses event delegation for efficiency.

            const codeSections = document.querySelectorAll('.code-section');
            let lastSelectedLanguage = localStorage.getItem('lastSelectedLanguage') || 'cpp';

            function updateCodeSection(section, language) {
                const tabs = section.querySelectorAll('.code-tab');
                const blocks = section.querySelectorAll('.code-block');

                tabs.forEach(tab => {
                    tab.classList.toggle('dsa_article_code_active', tab.dataset.lang === language);
                });

                blocks.forEach(block => {
                    block.classList.toggle('dsa_article_code_active', block.dataset.lang === language);
                });
            }

            function updateAllSections(language) {
                lastSelectedLanguage = language;
                localStorage.setItem('lastSelectedLanguage', language);
                codeSections.forEach(section => {
                    updateCodeSection(section, language);
                });
            }

            codeSections.forEach(section => {
                const tabsContainer = section.querySelector('.code-tabs');
                if (!tabsContainer) return;

                // Use event delegation on the container to handle clicks
                tabsContainer.addEventListener('click', (event) => {
                    const tabTarget = event.target.closest('.code-tab');
                    const copyTarget = event.target.closest('.copy-btn');

                    // Handle tab clicks
                    if (tabTarget) {
                        const lang = tabTarget.dataset.lang;
                        if (lang) {
                            updateAllSections(lang);
                        }
                    }

                    // Handle copy button clicks
                    if (copyTarget) {
                        const activeBlock = section.querySelector('.code-block.dsa_article_code_active code');
                        if (active.innerText) {
                            // Use the Clipboard API for modern browsers
                            navigator.clipboard.writeText(activeBlock.innerText).then(() => {
                                copyTarget.classList.add('dsa_article_code_active');
                                setTimeout(() => {
                                    copyTarget.classList.remove('dsa_article_code_active');
                                }, 1500);
                            }).catch(err => {
                                console.error('Failed to copy text: ', err);
                            });
                        }
                    }
                });
            });

            // Set the initial state for all sections on page load
            if (codeSections.length > 0) {
                updateAllSections(lastSelectedLanguage);
            }
        });
    </script>
</body>
</html>